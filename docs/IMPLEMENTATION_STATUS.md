# å®ç°çŠ¶æ€æ€»ç»“

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### Phase 1: æ ¸å¿ƒæ‹¦æˆªåŠŸèƒ½ âœ…
- [x] åˆ›å»º `faker-interceptor` åŒ…
- [x] å®ç° fetch æ‹¦æˆªå™¨
- [x] å®ç° XHR æ‹¦æˆªå™¨
- [x] é›†æˆ Faker.jsï¼ˆæµè§ˆå™¨ç«¯ï¼‰
- [x] å®ç° Mock åŒ¹é…é€»è¾‘
- [x] å®ç° WebSocket å®¢æˆ·ç«¯

### Phase 2: Node ç«¯æœåŠ¡ âœ…
- [x] å®ç° WebSocket æœåŠ¡å™¨ï¼ˆåŸºäº Vite HMR WebSocketï¼‰
- [x] JSON DB ç®¡ç†å™¨ï¼ˆä½¿ç”¨ LowDBï¼‰
- [x] é…ç½®åŒæ­¥æœºåˆ¶
- [x] è¯·æ±‚è®°å½•å­˜å‚¨

### Phase 3: UI åŸºç¡€åŠŸèƒ½ âœ…
- [x] å®ç° WebSocket å®¢æˆ·ç«¯ Composable
- [x] å®ç° Mock ç®¡ç† Composable
- [x] å®ç°è¯·æ±‚è®°å½• Composable
- [x] å®ç°è®¾ç½®ç®¡ç† Composable
- [x] é‡æ„ Mock åˆ—è¡¨ç»„ä»¶
- [x] é‡æ„è¯·æ±‚åˆ—è¡¨ç»„ä»¶
- [x] é‡æ„è®¾ç½®é¢æ¿ç»„ä»¶

### Phase 4: ç¼–è¾‘å™¨ âœ…
- [x] å®ç°ä»£ç ç¼–è¾‘å™¨ï¼ˆMonaco Editorï¼‰
- [x] å®ç° JSON ç¼–è¾‘å™¨
- [x] å®ç°å¯è§†åŒ–ç¼–è¾‘å™¨ï¼ˆåŸºç¡€ç‰ˆï¼‰

## ğŸ“ æ–‡ä»¶ç»“æ„

```
packages/
â”œâ”€â”€ faker-interceptor/          # æµè§ˆå™¨ç«¯æ‹¦æˆªå™¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ fetch-interceptor.ts
â”‚   â”‚   â”œâ”€â”€ xhr-interceptor.ts
â”‚   â”‚   â”œâ”€â”€ faker-generator.ts
â”‚   â”‚   â”œâ”€â”€ mock-matcher.ts
â”‚   â”‚   â”œâ”€â”€ ws-client.ts
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ vite-plugin-faker/          # Vite æ’ä»¶
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts            # æ’ä»¶å…¥å£ï¼ˆå·²æ›´æ–°ï¼‰
â”‚   â”‚   â”œâ”€â”€ ws-server.ts         # WebSocket æœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ virtual-modules.ts   # è™šæ‹Ÿæ¨¡å—
â”‚   â”‚   â””â”€â”€ db/                  # JSON DB
â”‚   â””â”€â”€ package.json
â”‚
â””â”€â”€ faker-ui/                   # UI åº”ç”¨
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ App.tsx              # ä¸»åº”ç”¨ï¼ˆå·²æ›´æ–°ï¼‰
    â”‚   â”œâ”€â”€ composables/
    â”‚   â”‚   â”œâ”€â”€ useWebSocket.ts  # WebSocket å®¢æˆ·ç«¯
    â”‚   â”‚   â”œâ”€â”€ useMock.ts        # Mock ç®¡ç†
    â”‚   â”‚   â”œâ”€â”€ useRequest.ts    # è¯·æ±‚è®°å½•
    â”‚   â”‚   â””â”€â”€ useSettings.ts   # è®¾ç½®ç®¡ç†
    â”‚   â”œâ”€â”€ api/
    â”‚   â”‚   â””â”€â”€ ws-api.ts         # WebSocket API å®¢æˆ·ç«¯
    â”‚   â””â”€â”€ components/
    â”‚       â”œâ”€â”€ mock-list.tsx    # Mock åˆ—è¡¨ï¼ˆå·²æ›´æ–°ï¼‰
    â”‚       â”œâ”€â”€ mock-editor.tsx  # Mock ç¼–è¾‘å™¨ï¼ˆå·²æ›´æ–°ï¼‰
    â”‚       â”œâ”€â”€ request-list.tsx # è¯·æ±‚åˆ—è¡¨ï¼ˆå·²æ›´æ–°ï¼‰
    â”‚       â”œâ”€â”€ settings-panel.tsx # è®¾ç½®é¢æ¿ï¼ˆå·²æ›´æ–°ï¼‰
    â”‚       â””â”€â”€ editors/
    â”‚           â”œâ”€â”€ code-editor.tsx
    â”‚           â”œâ”€â”€ json-editor.tsx
    â”‚           â””â”€â”€ visual-editor.tsx
    â””â”€â”€ package.json
```

## ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹

### 1. æ‹¦æˆªè„šæœ¬æ³¨å…¥
- ä½¿ç”¨ `injectTo: 'head-prepend'` ç¡®ä¿æœ€æ—©æ‰§è¡Œ
- åœ¨é¡µé¢åŠ è½½å‰å®Œæˆæ‹¦æˆªè®¾ç½®
- æ”¯æŒ fetch å’Œ XHR ä¸¤ç§æ–¹å¼

### 2. Faker.js æµè§ˆå™¨ç«¯ä½¿ç”¨
- é€šè¿‡ rolldown æ‰“åŒ… Faker.js åˆ°æ‹¦æˆªè„šæœ¬
- ä½¿ç”¨ IIFE æ ¼å¼ï¼Œå¯ç›´æ¥åœ¨æµè§ˆå™¨æ‰§è¡Œ
- æ”¯æŒä¸‰ç§ç”Ÿæˆæ¨¡å¼ï¼šstaticã€faker æ¨¡æ¿ã€è‡ªå®šä¹‰å‡½æ•°

### 3. WebSocket é€šä¿¡
- ä¼˜å…ˆä½¿ç”¨ Vite HMR WebSocketï¼ˆå¦‚æœå¯ç”¨ï¼‰
- é™çº§åˆ°ç‹¬ç«‹ WebSocket è¿æ¥
- é€šè¿‡è‡ªå®šä¹‰äº‹ä»¶ç±»å‹é€šä¿¡ï¼š`faker:message`ã€`faker:response`ã€`faker:broadcast`

### 4. JSON DB è®¾è®¡
- ä½¿ç”¨ LowDB ç®¡ç† JSON æ–‡ä»¶
- æ–‡ä»¶ç»“æ„å‹å¥½ï¼Œå¯ç›´æ¥ç¼–è¾‘
- æ”¯æŒ Mock é…ç½®ã€è¯·æ±‚è®°å½•ã€è®¾ç½®ä¸‰ç§æ•°æ®

### 5. ç¼–è¾‘å™¨æ”¯æŒ
- **ä»£ç ç¼–è¾‘å™¨**ï¼šMonaco Editorï¼Œæ”¯æŒ JS è¯­æ³•é«˜äº®å’Œ Faker API è¡¥å…¨
- **JSON ç¼–è¾‘å™¨**ï¼šç®€å•æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ”¯æŒ JSON æ ¼å¼åŒ–
- **å¯è§†åŒ–ç¼–è¾‘å™¨**ï¼šå­—æ®µåˆ—è¡¨å½¢å¼ï¼Œé€‰æ‹©ç±»å‹å’Œ Faker æ–¹æ³•

## ğŸš€ ä¸‹ä¸€æ­¥å·¥ä½œ

### éœ€è¦å®Œå–„çš„åŠŸèƒ½

1. **WebSocket é€šä¿¡ä¼˜åŒ–**
   - ç¡®ä¿æ­£ç¡®ä½¿ç”¨ Vite HMR WebSocket API
   - å®ç°å®¢æˆ·ç«¯ ID æ˜ å°„ï¼Œæ”¯æŒå•æ’­æ¶ˆæ¯
   - ä¼˜åŒ–é‡è¿æœºåˆ¶

2. **ç¼–è¾‘å™¨å¢å¼º**
   - Monaco Editor çš„ Faker API è‡ªåŠ¨è¡¥å…¨
   - å¯è§†åŒ–ç¼–è¾‘å™¨çš„æ‹–æ‹½æ’åº
   - å­—æ®µç±»å‹éªŒè¯

3. **é”™è¯¯å¤„ç†**
   - å®Œå–„çš„é”™è¯¯æç¤º
   - é™çº§æ–¹æ¡ˆï¼ˆWebSocket å¤±è´¥æ—¶ï¼‰
   - è¯·æ±‚å¤±è´¥é‡è¯•

4. **æ€§èƒ½ä¼˜åŒ–**
   - æ‹¦æˆªè„šæœ¬ä½“ç§¯ä¼˜åŒ–ï¼ˆTree-shakingï¼‰
   - è¯·æ±‚è®°å½•æ•°é‡é™åˆ¶
   - é…ç½®ç¼“å­˜æœºåˆ¶

5. **æµ‹è¯•**
   - å•å…ƒæµ‹è¯•
   - E2E æµ‹è¯•
   - å…¼å®¹æ€§æµ‹è¯•

## ğŸ“ ä½¿ç”¨è¯´æ˜

### å¼€å‘æ¨¡å¼

```bash
# æ„å»ºæ‹¦æˆªå™¨
cd packages/faker-interceptor
pnpm build

# æ„å»º UI
cd packages/faker-ui
pnpm build

# æ„å»ºæ’ä»¶
cd packages/vite-plugin-faker
pnpm build

# åœ¨é¡¹ç›®ä¸­ä½¿ç”¨
# vite.config.ts
import { viteFaker } from 'vite-plugin-faker'

export default defineConfig({
  plugins: [
    viteFaker({
      mountTarget: '#faker-ui',
      storeDir: '.mock',
    }),
  ],
})
```

### åŠŸèƒ½ä½¿ç”¨

1. **åˆ›å»º Mock**ï¼šç‚¹å‡»"æ–°å»º Mock"ï¼Œé€‰æ‹©å“åº”ç±»å‹ï¼Œé…ç½®æ•°æ®
2. **ç¼–è¾‘ Mock**ï¼šåœ¨åˆ—è¡¨ä¸­é€‰æ‹© Mockï¼Œç‚¹å‡»"ç¼–è¾‘"
3. **æŸ¥çœ‹è¯·æ±‚**ï¼šåœ¨"è¯·æ±‚è®°å½•"æ ‡ç­¾é¡µæŸ¥çœ‹æ‰€æœ‰è¯·æ±‚
4. **è®¾ç½®**ï¼šåœ¨"è®¾ç½®"æ ‡ç­¾é¡µé…ç½®å…¨å±€é€‰é¡¹

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ‹¦æˆªè„šæœ¬æ„å»º**ï¼šéœ€è¦å…ˆæ„å»º `faker-interceptor` æ‰èƒ½ä½¿ç”¨
2. **WebSocket è¿æ¥**ï¼šç¡®ä¿ Vite å¼€å‘æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
3. **Faker.js ä½“ç§¯**ï¼šæ‹¦æˆªè„šæœ¬åŒ…å« Faker.jsï¼Œä½“ç§¯è¾ƒå¤§ï¼ˆ~500KBï¼‰ï¼Œè€ƒè™‘æŒ‰éœ€åŠ è½½

## ğŸ› å·²çŸ¥é—®é¢˜

1. WebSocket æœåŠ¡å™¨éœ€è¦è¿›ä¸€æ­¥æµ‹è¯• Vite HMR WebSocket API çš„æ­£ç¡®ç”¨æ³•
2. å¯è§†åŒ–ç¼–è¾‘å™¨åŠŸèƒ½è¾ƒåŸºç¡€ï¼Œéœ€è¦å¢å¼º
3. é”™è¯¯å¤„ç†éœ€è¦å®Œå–„

